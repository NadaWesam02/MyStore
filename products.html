<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyStore - Home</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
<style> 
    .add-to-cart, .delete-btn {
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s;
        flex: 1;
    }

    .add-to-cart {
        background-color: #ff4785;
        color: white;
    }

    .add-to-cart:hover:not(:disabled) {
        background-color: #ff3a7a;
        transform: translateY(-2px);
    }

    .add-to-cart:disabled {
        background-color: #f47da3;
        cursor: not-allowed;
        opacity: 0.7;
    }

    .delete-btn {
        background-color: #ff4785;
        color: white;
        margin-left: 0.5rem;
    }

    .delete-btn:hover:not(:disabled) {
        background-color: #ff3a7a;
        transform: translateY(-2px);
    }

    .delete-btn:disabled {
        background-color: #f47da3;
        cursor: not-allowed;
        opacity: 0.5;
    }
    </style>
</head>
<body>
    <header>
        <div class="header-container">
            <h1 class="logo">MyStore</h1>
             <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="products.html">Products</a></li>
                    <li><a href="login.html" class="active">Login</a></li>
                    <li><a href="contactUs.html">Contact Us</a></li>
                    <li class="user-actions" style="display:none;">
                        <div class="dropdown">
                            <button class="user-icon">
                                <i class="bi bi-person-circle"></i>
                            </button>
                            <div class="dropdown-content">
                                <a href="#" id="logout-btn">Logout</a>
                            </div>
                        </div>
                    </li>
                </ul>
            </nav>
        </div>
    </header>
    
    <main class="container">
        <section aria-labelledby="products-heading">
            <h2 id="products-heading">Our Products</h2>
            
            <div class="products" id="products-container"></div>
            
            <div class="slogan">
                <p>Shooter Makes<br>Mouse everywhere</p>
            </div>
        </section>
    </main>
    
    <footer>
        <p>&copy; 2025 MyStore - All rights reserved</p>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const productsContainer = document.getElementById('products-container');
        let cart = JSON.parse(localStorage.getItem('cart')) || [];

        function fetchProducts() {
            fetch('http://localhost:3000/api/products')
                .then(response => response.json())
                .then(data => {
                    if(data.success) {
                        renderProducts(data.data);
                    } else {
                        throw new Error('Failed to load products');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    productsContainer.innerHTML = '<p class="error">Failed to load products. Please try again later.</p>';
                });
        }

        function renderProducts(products) {
            productsContainer.innerHTML = '';
            
            products.forEach(product => {
                const productCard = document.createElement('article');
                productCard.className = 'product-card';
                productCard.dataset.id = product.id;
                
                const stars = Math.round(product.rating);
                let ratingStars = '';
                for (let i = 1; i <= 5; i++) {
                    ratingStars += i <= stars ? '★' : '☆';
                }
                
                const isInCart = cart.some(item => item.id === product.id);
                
                productCard.innerHTML = `
                    <div class="product-image">
                        <img src="${product.image}" alt="${product.title}" onerror="this.src='images/placeholder.jpg'">
                    </div>
                    <div class="product-info">
                        <h3>${product.title}</h3>
                        <p>${product.description}</p>
                        <div class="rating">${ratingStars} (${product.rating.toFixed(1)})</div>
                        <div class="price">$${product.price.toFixed(2)}</div>
                        <div class="product-actions">
                            <button class="add-to-cart" data-id="${product.id}" ${isInCart ? 'disabled' : ''}>
                                Add to Cart
                            </button>
                            <button class="delete-btn" data-id="${product.id}" ${isInCart ? '' : 'disabled'}>
                                Delete
                            </button>
                        </div>
                    </div>
                `;
                
                productsContainer.appendChild(productCard);
            });
            
            setupEventListeners(products);
        }

        function setupEventListeners(products) {
            document.querySelectorAll('.add-to-cart').forEach(button => {
                button.addEventListener('click', function() {
                    const productId = parseInt(this.dataset.id);
                    const product = products.find(p => p.id === productId);
                    
                    cart.push(product);
                    localStorage.setItem('cart', JSON.stringify(cart));
                    
                    alert(`${product.title} added to cart!`);
                    this.disabled = true;
                    
                    const deleteBtn = this.parentElement.querySelector('.delete-btn');
                    deleteBtn.disabled = false;
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const productId = parseInt(this.dataset.id);
                    const product = products.find(p => p.id === productId);
                    
                    cart = cart.filter(item => item.id !== productId);
                    localStorage.setItem('cart', JSON.stringify(cart));
                    
                    alert(`${product.title} removed from cart!`);
                    this.disabled = true;
                    
                    const addBtn = this.parentElement.querySelector('.add-to-cart');
                    addBtn.disabled = false;
                });
            });
        }
        
        fetchProducts();
    });
    </script>

    <script src="auth.js"></script>
</body>
</html>